# Encrypt Labs 通关攻略 (困难模式-Burp+Python联动篇)

本攻略将以教程的形式，一步步带你分析`encrypt-labs`靶场（**困难模式**）的加密逻辑，并最终结合Burp Suite和Python脚本完成密码爆破。困难模式的重点在于**JavaScript反混淆**。

## 核心思想

与简单模式一样，我们使用Burp Intruder联动Python脚本进行爆破。但在此之前，我们必须先对`hard.js`进行反混淆，以揭示其真实的加密参数和逻辑。

## 第一步：JavaScript反混淆

这是攻克困难模式最关键的一步。`hard.js`的代码被故意弄得难以阅读。

1.  **混淆特征分析**：
    *   打开`static/js/hard.js`，你会看到代码头部有一个巨大的字符串数组（如`_0x5abf1c`）。
    *   紧接着是一个立即执行的匿名函数，它接收这个数组并对其进行位移、旋转操作。这是为了打乱数组的原始顺序，对抗静态分析。
    *   代码中所有的字符串、变量名、函数名都被替换成了类似`a0_0x9e8920(0x166)`这样的函数调用形式，该函数通过索引从被打乱的数组中提取真实的字符串。

2.  **反混淆方法**：
    *   **手动反混淆**：非常繁琐。你需要手动执行一遍数组的位移函数，得到最终顺序的数组，然后逐一替换代码中所有`a0_0x9e8920(...)`形式的调用。不推荐。
    *   **自动化工具**：这是最高效的方法。我们可以使用在线的JavaScript反混淆工具。一个非常出色的工具是 **`deobfuscator.io`**。

3.  **实战反混淆**：
    1.  将`hard.js`的全部代码复制出来。
    2.  访问 `https://deobfuscate.io/`。
    3.  将代码粘贴到输入框中。
    4.  点击“Deobfuscate”按钮，稍等片刻，右侧输出框就会显示出格式化、可读性强的代码。
    5.  **分析反混淆后的代码**：将输出的代码与`easy.js`进行对比，我们就能清晰地发现困难模式在哪些地方修改了加密参数（如Key, IV, URL, 公钥等）。